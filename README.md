


Домашнее задание к занятию "3.1. Работа в терминале, лекция 1"

1.Ознакомьтесь с графическим интерфейсом VirtualBox, посмотрите как выглядит виртуальная машина, которую создал для вас
Vagrant, какие аппаратные ресурсы ей выделены. Какие ресурсы выделены по-умолчанию?  
Ответ
По умолчанию выдано 2 CPU и 1024 MB RAM  
[скриншот](https://drive.google.com/file/d/1Tc3lQRyYFO_xWCsJiCLKhCCWcXSF5qnn/view?usp=sharing)  

2.Ознакомьтесь с возможностями конфигурации VirtualBox через Vagrantfile: документация. Как добавить оперативной памяти
или ресурсов процессора виртуальной машине?  
Ответ: Необходимо изменить конфиг файл vagrantfile и перезапустить ВМ (vagrant reload).  
Например 

 Vagrant.configure("2") do |config|  

 	config.vm.box = "bento/ubuntu-20.04"
	config.vm.provider "virtualbox" do |v|
		v.memory = 4128
		v.cpus = 4
	end
 end   
3. Какой переменной можно задать длину журнала history, и на какой строчке manual это описывается?  
 Ответ: Описывается начиная с 792 строчки манула  

4. Что делает директива ignoreboth в bash?  
Ответ: Директива ignoreboth делает тоже самое что и директива ignorespace:ignoredups.
Если в файл ~/.bashrc добавить строку HISTCONTROL=ignoreboth или
HISTCONTROL=ignoreboth:erasedups в истории не будут сохраняться строки начинающиеся с символа пробел и дублирующиеся
(совпадающие с последней выполненной) команды.  
5. В каких сценариях использования применимы скобки {} и на какой строчке man bash это описано?  
Ответ: Строка 241, {} применяется для создания составных комманд, команды находящиеся в {} будут выполнены в
контексте текущего процесса (терминала), и результаты их вызова будут сохранены в текущем контексте (можно задать
функции имя и в последствии в данном терминале неоднократно вызывать её).
Команды выполненные в () будут исполнятся в дочернем процессе и после отработки удаляться из памяти.  
6. Основываясь на предыдущем вопросе, как создать однократным вызовом touch 100000 файлов?
А получилось ли создать 300000? Если нет, то почему?  
Ответ: touch {1..300000} не удалось создать без изменения переменной ARG_MAX (увеличить ограничение 
на объём передаваемых аргументов комманде) в большинстве случаев не получится.  
[Скриншот](https://drive.google.com/file/d/1NMtObGmaZMqxc-ZnQyDUpUp6tWdXFJWi/view?usp=sharing) 
7. В man bash поищите по /\[\[. Что делает конструкция [[ -d /tmp ]].  
Ответ: Конструкция [[ -d /tmp ]] вернёт 0 при наличии каталога /tmp.  
8. Основываясь на знаниях о просмотре текущих (например, PATH) и установке новых переменных; командах,
которые мы рассматривали, добейтесь в выводе type -a bash в виртуальной машине наличия первым пунктом в списке  
Ответ: 
# Создаем каталог
mkdir /tmp/new_path_directory
# Копируем в него файл bash
cp /bin/bash /tmp/new_path_directory/
# Добавляем каталог в переменную $PATH (в начало) 
PATH=/tmp/new_path_directory/bash:$PATH
# Выводим переменную, чтобы убедиться в корректности
echo $PATH
# Выполняем type -a
type -a bash  
[Скриншот ](https://drive.google.com/file/d/1ig26zF7p1cSCV1-N3K9PhLDB4FYe5nQB/view?usp=sharing) 
9. Чем отличается планирование команд с помощью batch и at?  
At используется для планирования разовой задачи, которая должна выполниться в определенное время
Batch используется для выполнения разовой задачи, когда позволит средняя нагрузка 
(в man указано, когда средняя нагрузка упадет ниже 1.5)  


# Домашнее задание к занятию "3.2. Работа в терминале, лекция 2


Какого типа команда cd? Попробуйте объяснить, почему она именно такого типа; опишите ход своих мыслей, если считаете   
что она могла бы быть другого типа.

Ответ:  cd - это shell builtin команда, то есть команда, которая вызывается напрямую в shell, а не как   
внешняя исполняемая. Если бы она была внешней, то запускалась бы в отдельном процессе но мы этого не наблюдаем

Какая альтернатива без pipe команде grep <some_string> <some_file> | wc -l?  

Ответ: grep <some_string> <some_file> -c


Какой процесс с PID 1 является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?

Ответ: [Скриншот ](https://drive.google.com/file/d/1RIWoAj_d2Es2GcXuBL92W9FefNR4PLms/view?usp=sharing)  

Как будет выглядеть команда, которая перенаправит вывод stderr ls на другую сессию терминала?

Ответ: Для этого откроем второй терминал для наглядности и с имитируем ошибку [пример](https://drive.google.com/file/d/1lJYSAsYHm1Wr0A8oUyt434tIECdvlx3o/view?usp=sharing)
ls -l \root 2>/dev/pts/1

Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл? Приведите работающий пример.  
Ответ: Да получиться например вот так:  
cat <test1.txt >test.txt  
vagrant@vagrant:~$ echo Привет >test1.txt  
vagrant@vagrant:~$ cat <test1.txt >test.txt  
vagrant@vagrant:~$ cat test.txt  
Привет  

Получится ли находясь в графическом режиме, вывести данные из PTY в какой-либо из эмуляторов TTY?  
Сможете ли вы наблюдать выводимые данные?

Ответ: Да получиться  

Выполните команду bash 5>&1. К чему она приведет? Что будет, если вы выполните
echo netology > /proc/$$/fd/5? Почему так происходит?

Ответ: bash 5>&1 -перенаправит вывод с созданного дескриптора 5 в stdout (дескриптор 1).
echo netology > /proc/$$/fd/5 -выведет в дескриптор 5 "netology",
т.к. дескриптор 5 перенаправлен в stdout "netology" мы увидим в терминале.  


Получится ли в качестве входного потока для pipe использовать только stderr команды,
не потеряв при этом отображение stdout на pty? Напоминаем: по умолчанию через pipe передается только stdout 
команды слева от | на stdin команды справа. Это можно сделать, поменяв стандартные потоки местами через промежуточный
новый дескриптор, который вы научились создавать в предыдущем вопросе.

Решение: 

vagrant@vagrant:~$ ls -l /root 9>&2 2>&1 1>&9 |grep denied -c   
1

9>&2 - новый дескриптор перенаправили в stderr  
2>&1 - stderr перенаправили в stdout   
1>&9 - stdout - перенаправили в в новый дескриптор  

Что выведет команда cat /proc/$$/environ? Как еще можно получить аналогичный по содержанию вывод?

Ответ: Выводится список переменных окружения для процесса, под которым выполняется текущая оболочка  
Аналогичный вывод можно получить с помощью команды printenv

Используя man, опишите что доступно по адресам /proc//cmdline, /proc//exe

Ответ: /proc/[pid]/cmdline - файл только на чтение, который содержит строку запуска процессов, 
кроме зомби-процессов 
/proc/[pid]/exe - сожержит полное имя выполняемого файла для процесса 


Узнайте, какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с
помощью /proc/cpuinfo

Ответ [скриншот](https://drive.google.com/file/d/1317WVYOJPo3wOyYT_Dz4t3eLgcmCpB7B/view?usp=sharing)

При открытии нового окна терминала и vagrant ssh создается новая сессия и выделяется pty. Это можно подтвердить
командой tty, которая упоминалась в лекции 3.2
Решение:
По умолчанию при запуске команды через SSH не выделяется TTY. Если же не указывать команды,
то TTY будет выдаваться, так как предполагается, что будет запущен сеанс оболочки. Полагаю, что изменить поведение 
можно через ssh localhost с последующей авторизацией и выполнением 'tty'. Либо через ssh -t localhost 'tty'


Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Попробуйте сделать это,
воспользовавшись reptyr. Например, так можно перенести в screen процесс,
который вы запустили по ошибке в обычной SSH-сессии.

Решешие: Получилось после правки /proc/sys/kernel/yama/ptrace_scope

Узнайте что делает команда tee и почему в отличие от sudo echo команда с sudo tee будет работать.

Ответ tee - получает значения из stdin и записывает их в stdout и файл.Будет работать т.к.
в данном случае запись в файл будет осуществляться командой tee запущенной от рута
(и соответственно имеющей необходимые права).







